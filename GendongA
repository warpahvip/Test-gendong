-- SCRIPT UNTUK DEVICE PENGGENDONG (CARRIER)  
-- Delta Executor Android - Carry System (Minimalis)

local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local TweenService = game:GetService("TweenService")

local LocalPlayer = Players.LocalPlayer
local PlayerGui = LocalPlayer:WaitForChild("PlayerGui")
local Character = LocalPlayer.Character or LocalPlayer.CharacterAdded:Wait()
local Humanoid = Character:WaitForChild("Humanoid")
local RootPart = Character:WaitForChild("HumanoidRootPart")

-- Variabel Global
local isCarrying = false
local carriedPlayer = nil
local nearbyPlayers = {}
local detectionRange = 12
local carryTrack = nil

-- GUI Setup (Minimalis)
local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Name = "CarrySystemGUI"
ScreenGui.Parent = PlayerGui

-- Main Frame (Lebih kecil)
local MainFrame = Instance.new("Frame")
MainFrame.Name = "MainFrame"
MainFrame.Size = UDim2.new(0, 200, 0, 200)
MainFrame.Position = UDim2.new(0, 10, 0, 10)
MainFrame.BackgroundColor3 = Color3.fromRGB(20, 20, 20)
MainFrame.BorderSizePixel = 0
MainFrame.BackgroundTransparency = 0.1
MainFrame.Parent = ScreenGui

local Corner = Instance.new("UICorner")
Corner.CornerRadius = UDim.new(0, 8)
Corner.Parent = MainFrame

-- Title (Lebih compact)
local Title = Instance.new("TextLabel")
Title.Name = "Title"
Title.Size = UDim2.new(1, 0, 0, 25)
Title.Position = UDim2.new(0, 0, 0, 0)
Title.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
Title.BorderSizePixel = 0
Title.Text = "ðŸŽ’ CARRIER"
Title.TextColor3 = Color3.fromRGB(255, 255, 255)
Title.TextScaled = true
Title.Font = Enum.Font.GothamBold
Title.Parent = MainFrame

local TitleCorner = Instance.new("UICorner")
TitleCorner.CornerRadius = UDim.new(0, 8)
TitleCorner.Parent = Title

-- Status (Lebih kecil)
local StatusLabel = Instance.new("TextLabel")
StatusLabel.Name = "StatusLabel"
StatusLabel.Size = UDim2.new(1, -10, 0, 20)
StatusLabel.Position = UDim2.new(0, 5, 0, 30)
StatusLabel.BackgroundTransparency = 1
StatusLabel.Text = "ðŸ“¡ Ready"
StatusLabel.TextColor3 = Color3.fromRGB(100, 255, 100)
StatusLabel.TextScaled = true
StatusLabel.Font = Enum.Font.Gotham
StatusLabel.TextXAlignment = Enum.TextXAlignment.Left
StatusLabel.Parent = MainFrame

-- Players ScrollFrame (Lebih compact)
local PlayersFrame = Instance.new("ScrollingFrame")
PlayersFrame.Name = "PlayersFrame"
PlayersFrame.Size = UDim2.new(1, -10, 0, 120)
PlayersFrame.Position = UDim2.new(0, 5, 0, 55)
PlayersFrame.BackgroundColor3 = Color3.fromRGB(15, 15, 15)
PlayersFrame.BorderSizePixel = 0
PlayersFrame.CanvasSize = UDim2.new(0, 0, 0, 0)
PlayersFrame.ScrollBarThickness = 4
PlayersFrame.BackgroundTransparency = 0.2
PlayersFrame.Parent = MainFrame

local PlayersCorner = Instance.new("UICorner")
PlayersCorner.CornerRadius = UDim.new(0, 6)
PlayersCorner.Parent = PlayersFrame

local PlayersLayout = Instance.new("UIListLayout")
PlayersLayout.SortOrder = Enum.SortOrder.Name
PlayersLayout.Padding = UDim.new(0, 3)
PlayersLayout.Parent = PlayersFrame

-- Release Button (Lebih kecil)
local ReleaseButton = Instance.new("TextButton")
ReleaseButton.Name = "ReleaseButton"
ReleaseButton.Size = UDim2.new(1, -10, 0, 25)
ReleaseButton.Position = UDim2.new(0, 5, 0, 180)
ReleaseButton.BackgroundColor3 = Color3.fromRGB(255, 60, 60)
ReleaseButton.BorderSizePixel = 0
ReleaseButton.Text = "ðŸ”“ LEPAS"
ReleaseButton.TextColor3 = Color3.fromRGB(255, 255, 255)
ReleaseButton.TextScaled = true
ReleaseButton.Font = Enum.Font.GothamBold
ReleaseButton.Visible = false
ReleaseButton.Parent = MainFrame

local ReleaseCorner = Instance.new("UICorner")
ReleaseCorner.CornerRadius = UDim.new(0, 6)
ReleaseCorner.Parent = ReleaseButton

-- Fungsi untuk membuat tombol player
local function createPlayerButton(player, distance)
    local button = Instance.new("TextButton")
    button.Name = player.Name
    button.Size = UDim2.new(1, -5, 0, 25)
    button.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
    button.BorderSizePixel = 0
    button.Text = string.format("%s (%.0fm)", player.DisplayName or player.Name, distance)
    button.TextColor3 = Color3.fromRGB(255, 255, 255)
    button.TextScaled = true
    button.Font = Enum.Font.Gotham
    button.Parent = PlayersFrame
    
    local buttonCorner = Instance.new("UICorner")
    buttonCorner.CornerRadius = UDim.new(0, 4)
    buttonCorner.Parent = button
    
    -- Hover effect
    button.MouseEnter:Connect(function()
        TweenService:Create(button, TweenInfo.new(0.15), {BackgroundColor3 = Color3.fromRGB(60, 60, 60)}):Play()
    end)
    
    button.MouseLeave:Connect(function()
        TweenService:Create(button, TweenInfo.new(0.15), {BackgroundColor3 = Color3.fromRGB(40, 40, 40)}):Play()
    end)
    
    -- Click event - Langsung gendong
    button.MouseButton1Click:Connect(function()
        if not isCarrying then
            carryPlayerDirectly(player)
        end
    end)
    
    return button
end

-- Fungsi untuk langsung menggendong player
function carryPlayerDirectly(targetPlayer)
    if isCarrying or not targetPlayer or not targetPlayer.Character then
        return
    end
    
    local targetCharacter = targetPlayer.Character
    local targetRootPart = targetCharacter:FindFirstChild("HumanoidRootPart")
    local targetHumanoid = targetCharacter:FindFirstChild("Humanoid")
    
    if not targetRootPart or not targetHumanoid then
        return
    end
    
    -- Set carrying state
    isCarrying = true
    carriedPlayer = targetPlayer
    
    -- Update UI
    StatusLabel.Text = "ðŸŽ’ " .. (targetPlayer.DisplayName or targetPlayer.Name)
    StatusLabel.TextColor3 = Color3.fromRGB(255, 200, 100)
    ReleaseButton.Visible = true
    PlayersFrame.Visible = false
    
    -- Disable target controls
    targetHumanoid.PlatformStand = true
    
    -- Create WeldConstraint for instant attachment
    local weld = Instance.new("WeldConstraint")
    weld.Name = "CarryWeld"
    weld.Part0 = targetRootPart
    weld.Part1 = RootPart
    weld.Parent = targetRootPart
    
    -- Position target di pundak
    local offset = CFrame.new(0, 2, -1.2) * CFrame.Angles(math.rad(-10), 0, 0)
    targetRootPart.CFrame = RootPart.CFrame * offset
    
    -- Set attributes
    targetCharacter:SetAttribute("IsBeingCarried", true)
    targetCharacter:SetAttribute("CarrierName", LocalPlayer.Name)
    
    -- Carrier animation
    if carryTrack then carryTrack:Stop() end
    local carryAnim = Instance.new("Animation")
    carryAnim.AnimationId = "rbxassetid://507766388"
    carryTrack = Humanoid:LoadAnimation(carryAnim)
    carryTrack:Play()
    carryTrack.Looped = true
    
    -- Monitor carried player
    local connection
    connection = RunService.Heartbeat:Connect(function()
        if not targetCharacter.Parent or not targetRootPart.Parent then
            releasePlayer()
            connection:Disconnect()
        end
    end)
end

-- Fungsi untuk melepas player
function releasePlayer()
    if not isCarrying or not carriedPlayer then
        return
    end
    
    local targetCharacter = carriedPlayer.Character
    if targetCharacter then
        local targetHumanoid = targetCharacter:FindFirstChild("Humanoid")
        local targetRootPart = targetCharacter:FindFirstChild("HumanoidRootPart")
        
        if targetHumanoid then
            targetHumanoid.PlatformStand = false
        end
        
        -- Remove weld
        if targetRootPart then
            local weld = targetRootPart:FindFirstChild("CarryWeld")
            if weld then
                weld:Destroy()
            end
        end
        
        -- Remove attributes
        targetCharacter:SetAttribute("IsBeingCarried", nil)
        targetCharacter:SetAttribute("CarrierName", nil)
    end
    
    -- Stop animation
    if carryTrack then
        carryTrack:Stop()
        carryTrack = nil
    end
    
    -- Reset state
    isCarrying = false
    carriedPlayer = nil
    
    -- Update UI
    StatusLabel.Text = "ðŸ“¡ Ready"
    StatusLabel.TextColor3 = Color3.fromRGB(100, 255, 100)
    ReleaseButton.Visible = false
    PlayersFrame.Visible = true
end

-- Release button event
ReleaseButton.MouseButton1Click:Connect(function()
    releasePlayer()
end)

-- Update nearby players
local function updateNearbyPlayers()
    if not Character or not RootPart or isCarrying then
        return
    end
    
    -- Clear existing buttons
    for _, child in pairs(PlayersFrame:GetChildren()) do
        if child:IsA("TextButton") then
            child:Destroy()
        end
    end
    
    nearbyPlayers = {}
    
    for _, player in pairs(Players:GetPlayers()) do
        if player ~= LocalPlayer and player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
            local distance = (RootPart.Position - player.Character.HumanoidRootPart.Position).Magnitude
            
            if distance <= detectionRange and not player.Character:GetAttribute("IsBeingCarried") then
                table.insert(nearbyPlayers, {player = player, distance = distance})
            end
        end
    end
    
    -- Sort by distance
    table.sort(nearbyPlayers, function(a, b)
        return a.distance < b.distance
    end)
    
    -- Create buttons
    for _, data in pairs(nearbyPlayers) do
        createPlayerButton(data.player, data.distance)
    end
    
    -- Update canvas size
    PlayersFrame.CanvasSize = UDim2.new(0, 0, 0, #nearbyPlayers * 28)
end

-- Main update loop
RunService.Heartbeat:Connect(function()
    if not isCarrying then
        updateNearbyPlayers()
    end
end)

-- Character respawn handler
LocalPlayer.CharacterAdded:Connect(function(newCharacter)
    Character = newCharacter
    Humanoid = Character:WaitForChild("Humanoid")
    RootPart = Character:WaitForChild("HumanoidRootPart")
    releasePlayer()
end)

-- Player leaving handler
Players.PlayerRemoving:Connect(function(player)
    if carriedPlayer == player then
        releasePlayer()
    end
end)

print("âœ… Carry System (CARRIER) - Minimalis loaded!")
print("ðŸ’¡ Klik nama player untuk langsung gendong")
