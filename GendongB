
-- SCRIPT 2 - UNTUK HP KEDUA (RECEIVER) 
-- Copy script ini dan execute di HP kedua
-- ==========================================
-- ==========================================

local Players = game:GetService("Players")
local UserInputService = game:GetService("UserInputService")
local RunService = game:GetService("RunService")

local LocalPlayer = Players.LocalPlayer
local PlayerGui = LocalPlayer:WaitForChild("PlayerGui")

local isAttached = false
local carrierPlayer = nil
local monitorConnection = nil

-- Create GUI for HP 2
local function createReceiverGUI()
    local gui = Instance.new("ScreenGui")
    gui.Name = "ReceiverGUI"
    gui.Parent = PlayerGui
    
    local frame = Instance.new("Frame")
    frame.Size = UDim2.new(0, 180, 0, 70)
    frame.Position = UDim2.new(1, -190, 0, 10)
    frame.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
    frame.BorderSizePixel = 0
    frame.Parent = gui
    
    local corner = Instance.new("UICorner")
    corner.CornerRadius = UDim.new(0, 8)
    corner.Parent = frame
    
    local stroke = Instance.new("UIStroke")
    stroke.Color = Color3.fromRGB(255, 100, 150)
    stroke.Thickness = 2
    stroke.Parent = frame
    
    local title = Instance.new("TextLabel")
    title.Size = UDim2.new(1, 0, 0, 25)
    title.BackgroundColor3 = Color3.fromRGB(255, 100, 150)
    title.Text = "HP 2 - RECEIVER"
    title.TextColor3 = Color3.white
    title.TextSize = 12
    title.Font = Enum.Font.GothamBold
    title.TextXAlignment = Enum.TextXAlignment.Center
    title.Parent = frame
    
    local titleCorner = Instance.new("UICorner")
    titleCorner.CornerRadius = UDim.new(0, 8)
    titleCorner.Parent = title
    
    local status = Instance.new("TextLabel")
    status.Name = "Status"
    status.Size = UDim2.new(1, -10, 0, 40)
    status.Position = UDim2.new(0, 5, 0, 30)
    status.BackgroundTransparency = 1
    status.Text = "Siap digendong..."
    status.TextColor3 = Color3.fromRGB(200, 200, 200)
    status.TextSize = 11
    status.Font = Enum.Font.Gotham
    status.TextXAlignment = Enum.TextXAlignment.Center
    status.Parent = frame
    
    return frame, status
end

-- Attach to carrier
local function attachToCarrier(carrier)
    if isAttached then return end
    
    isAttached = true
    carrierPlayer = carrier
    
    local myChar = LocalPlayer.Character
    local myRoot = myChar:FindFirstChild("HumanoidRootPart")
    local myHumanoid = myChar:FindFirstChild("Humanoid")
    
    if myRoot and myHumanoid then
        -- Disable movement
        myHumanoid.PlatformStand = true
        myHumanoid.WalkSpeed = 0
        myHumanoid.JumpPower = 0
        
        -- Create BodyPosition for smooth following
        local bodyPos = Instance.new("BodyPosition")
        bodyPos.MaxForce = Vector3.new(4000, 4000, 4000)
        bodyPos.D = 2500
        bodyPos.P = 12000
        bodyPos.Parent = myRoot
        
        -- Update position loop
        spawn(function()
            while isAttached and carrierPlayer and carrierPlayer.Character do
                local carrierRoot = carrierPlayer.Character:FindFirstChild("HumanoidRootPart")
                if carrierRoot and bodyPos then
                    local carrierCFrame = carrierRoot.CFrame
                    local shoulderPos = carrierCFrame.Position + carrierCFrame.UpVector * 1.7 + carrierCFrame.RightVector * 1.3
                    bodyPos.Position = shoulderPos
                else
                    break
                end
                wait(0.1)
            end
        end)
    end
    
    print("Attached to " .. carrier.Name)
end

-- Detach from carrier  
local function detachFromCarrier()
    if not isAttached then return end
    
    isAttached = false
    
    local myChar = LocalPlayer.Character
    if myChar then
        local myRoot = myChar:FindFirstChild("HumanoidRootPart")
        local myHumanoid = myChar:FindFirstChild("Humanoid")
        
        -- Remove BodyPosition
        if myRoot then
            for _, obj in pairs(myRoot:GetChildren()) do
                if obj:IsA("BodyPosition") then
                    obj:Destroy()
                end
            end
        end
        
        -- Restore movement
        if myHumanoid then
            myHumanoid.PlatformStand = false
            myHumanoid.WalkSpeed = 16
            myHumanoid.JumpPower = 50
        end
    end
    
    carrierPlayer = nil
    print("Detached from carrier")
end

-- Monitor signals
local function startMonitoring()
    monitorConnection = RunService.Heartbeat:Connect(function()
        -- Check for carry signals
        for _, obj in pairs(workspace:GetChildren()) do
            if obj.Name == "CarrySignal" and obj:IsA("StringValue") then
                local data = obj.Value:split(":")
                if data[1] == "START" then
                    local carrierId = tonumber(data[2])
                    local carrier = Players:GetPlayerByUserId(carrierId)
                    if carrier and carrier ~= LocalPlayer then
                        attachToCarrier(carrier)
                        obj:Destroy()
                    end
                end
            end
            
            -- Check for stop signals
            if obj.Name == "StopSignal" and obj:IsA("StringValue") then
                local data = obj.Value:split(":")
                if data[1] == "STOP" then
                    detachFromCarrier()
                    obj:Destroy()
                end
            end
        end
    end)
end

-- Auto-attach to first available player
local function autoAttach()
    wait(2) -- Wait for other scripts to load
    
    for _, player in pairs(Players:GetPlayers()) do
        if player ~= LocalPlayer and player.Character then
            attachToCarrier(player)
            break
        end
    end
end

-- Setup
local mainFrame, statusLabel = createReceiverGUI()

UserInputService.InputBegan:Connect(function(input)
    if input.KeyCode == Enum.KeyCode.T then
        if isAttached then
            detachFromCarrier()
            statusLabel.Text = "Siap digendong..."
        else
            autoAttach()
        end
    elseif input.KeyCode == Enum.KeyCode.R then
        mainFrame.Visible = not mainFrame.Visible
    end
end)

startMonitoring()
autoAttach() -- Auto-attach saat script dimulai

print("HP 2 RECEIVER READY - T to toggle attach/detach, R to toggle GUI")

-- ==========================================
-- COPY KEDUA SCRIPT DI BAWAH INI SECARA TERPISAH
-- ==========================================


-- ==========================================
-- SCRIPT 2 - UNTUK HP KEDUA (RECEIVER)  
-- Copy script ini dan execute di HP kedua
-- ==========================================

local Players = game:GetService("Players")
local UserInputService = game:GetService("UserInputService")
local RunService = game:GetService("RunService")

local LocalPlayer = Players.LocalPlayer
local PlayerGui = LocalPlayer:WaitForChild("PlayerGui")

local isAttached = false
local carrierPlayer = nil
local monitorConnection = nil

-- Create GUI for receiver
local function createReceiverGUI()
    local gui = Instance.new("ScreenGui")
    gui.Name = "ReceiverGUI"
    gui.Parent = PlayerGui
    
    local frame = Instance.new("Frame")
    frame.Size = UDim2.new(0, 180, 0, 70)
    frame.Position = UDim2.new(1, -190, 0, 10)
    frame.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
    frame.BorderSizePixel = 0
    frame.Parent = gui
    
    local corner = Instance.new("UICorner")
    corner.CornerRadius = UDim.new(0, 8)
    corner.Parent = frame
    
    local stroke = Instance.new("UIStroke")
    stroke.Color = Color3.fromRGB(255, 100, 150)
    stroke.Thickness = 2
    stroke.Parent = frame
    
    local title = Instance.new("TextLabel")
    title.Size = UDim2.new(1, 0, 0, 25)
    title.BackgroundColor3 = Color3.fromRGB(255, 100, 150)
    title.Text = "HP 2 - RECEIVER"
    title.TextColor3 = Color3.white
    title.TextSize = 12
    title.Font = Enum.Font.GothamBold
    title.TextXAlignment = Enum.TextXAlignment.Center
    title.Parent = frame
    
    local titleCorner = Instance.new("UICorner")
    titleCorner.CornerRadius = UDim.new(0, 8)
    titleCorner.Parent = title
    
    local status = Instance.new("TextLabel")
    status.Name = "Status"
    status.Size = UDim2.new(1, -10, 0, 40)
    status.Position = UDim2.new(0, 5, 0, 30)
    status.BackgroundTransparency = 1
    status.Text = "Siap digendong..."
    status.TextColor3 = Color3.fromRGB(200, 200, 200)
    status.TextSize = 11
    status.Font = Enum.Font.Gotham
    status.TextXAlignment = Enum.TextXAlignment.Center
    status.Parent = frame
    
    return frame, status
end

-- Attach to carrier
local function attachToCarrier(carrier)
    if isAttached then return end
    
    isAttached = true
    carrierPlayer = carrier
    
    local myChar = LocalPlayer.Character
    local myRoot = myChar:FindFirstChild("HumanoidRootPart")
    local myHumanoid = myChar:FindFirstChild("Humanoid")
    
    if myRoot and myHumanoid then
        -- Disable movement
        myHumanoid.PlatformStand = true
        myHumanoid.WalkSpeed = 0
        myHumanoid.JumpPower = 0
        
        -- Create BodyPosition
        local bodyPos = Instance.new("BodyPosition")
        bodyPos.MaxForce = Vector3.new(4000, 4000, 4000)
        bodyPos.D = 2500
        bodyPos.P = 12000
        bodyPos.Parent = myRoot
        
        -- Update position
        spawn(function()
            while isAttached and carrierPlayer and carrierPlayer.Character do
                local carrierRoot = carrierPlayer.Character:FindFirstChild("HumanoidRootPart")
                if carrierRoot and bodyPos and bodyPos.Parent then
                    local carrierCFrame = carrierRoot.CFrame
                    local shoulderPos = carrierCFrame.Position + carrierCFrame.UpVector * 1.7 + carrierCFrame.RightVector * 1.3
                    bodyPos.Position = shoulderPos
                else
                    break
                end
                wait(0.05)
            end
        end)
    end
    
    print("Attached to " .. carrier.Name)
end

-- Detach
local function detachFromCarrier()
    if not isAttached then return end
    
    isAttached = false
    
    local myChar = LocalPlayer.Character
    if myChar then
        local myRoot = myChar:FindFirstChild("HumanoidRootPart")
        local myHumanoid = myChar:FindFirstChild("Humanoid")
        
        -- Remove BodyPosition
        if myRoot then
            for _, obj in pairs(myRoot:GetChildren()) do
                if obj:IsA("BodyPosition") then
                    obj:Destroy()
                end
            end
        end
        
        -- Restore movement
        if myHumanoid then
            myHumanoid.PlatformStand = false
            myHumanoid.WalkSpeed = 16
            myHumanoid.JumpPower = 50
        end
    end
    
    carrierPlayer = nil
    print("Detached")
end

-- Monitor signals
local function startMonitoring()
    monitorConnection = RunService.Heartbeat:Connect(function()
        for _, obj in pairs(workspace:GetChildren()) do
            if obj.Name == "CarrySignal" and obj:IsA("StringValue") then
                local data = obj.Value:split(":")
                if data[1] == "START" then
                    local carrierId = tonumber(data[2])
                    local carrier = Players:GetPlayerByUserId(carrierId)
                    if carrier and carrier ~= LocalPlayer then
                        attachToCarrier(carrier)
                        obj:Destroy()
                    end
                end
            end
            
            if obj.Name == "StopSignal" and obj:IsA("StringValue") then
                detachFromCarrier()
                obj:Destroy()
            end
        end
    end)
end

-- Auto-attach
local function autoAttach()
    wait(1)
    for _, player in pairs(Players:GetPlayers()) do
        if player ~= LocalPlayer and player.Character then
            attachToCarrier(player)
            break
        end
    end
end

-- Setup HP 2
local mainFrame, statusLabel = createReceiverGUI()

UserInputService.InputBegan:Connect(function(input)
    if input.KeyCode == Enum.KeyCode.T then
        if isAttached then
            detachFromCarrier()
            statusLabel.Text = "Siap digendong..."
            statusLabel.TextColor3 = Color3.fromRGB(200, 200, 200)
        else
            autoAttach()
        end
    elseif input.KeyCode == Enum.KeyCode.R then
        mainFrame.Visible = not mainFrame.Visible
    end
end)

startMonitoring()

-- Auto-attach when script runs
spawn(function()
    autoAttach()
    if isAttached and statusLabel then
        statusLabel.Text = "Tergendong!"
        statusLabel.TextColor3 = Color3.fromRGB(0, 255, 100)
    end
end)

print("HP 2 RECEIVER READY - Will auto-attach to HP 1")
